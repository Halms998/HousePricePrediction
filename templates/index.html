<!DOCTYPE html>
<html>
<head>
    <title>Pakistan House Price Prediction</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 40px; 
            background-color: #f5f5f5;
        }
        .container { 
            max-width: 600px; 
            margin: 0 auto; 
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { 
            color: #2c3e50; 
            text-align: center;
            margin-bottom: 30px;
        }
        .form-group { 
            margin-bottom: 20px; 
        }
        label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: bold;
            color: #34495e;
        }
        input, select { 
            width: 100%; 
            padding: 12px; 
            box-sizing: border-box; 
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button { 
            padding: 15px 30px; 
            background: #3498db; 
            color: white; 
            border: none; 
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
            width: 100%;
            margin-top: 10px;
        }
        button:hover {
            background: #2980b9;
        }
        .result { 
            margin-top: 30px; 
            padding: 20px; 
            background: #ecf0f1; 
            border-radius: 5px; 
            display: none;
        }
        .result h3 {
            color: #27ae60;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè† Pakistan House Price Prediction</h1>
        <form id="prediction-form">
            <div class="form-group">
                <label for="area">Area (sq ft):</label>
                <input type="number" id="area" name="area" required placeholder="e.g., 1250">
            </div>
            <div class="form-group">
                <label for="bedrooms">Bedrooms:</label>
                <input type="number" id="bedrooms" name="bedrooms" required placeholder="e.g., 3">
            </div>
            <div class="form-group">
                <label for="bathrooms">Bathrooms:</label>
                <input type="number" id="bathrooms" name="bathrooms" required placeholder="e.g., 2">
            </div>
            <div class="form-group">
                <label for="city">City:</label>
                <input type="text" id="city" name="city" required placeholder="e.g., Karachi">
            </div>
            <div class="form-group">
                <label for="province">Province:</label>
                <select id="province" name="province" required>
                    <option value="">Select Province</option>
                    <option value="Sindh">Sindh</option>
                    <option value="Punjab">Punjab</option>
                    <option value="Khyber Pakhtunkhwa">Khyber Pakhtunkhwa</option>
                    <option value="Balochistan">Balochistan</option>
                    <option value="Islamabad Capital Territory">Islamabad</option>
                </select>
            </div>
            <div class="form-group">
                <label for="property_type">Property Type:</label>
                <select id="property_type" name="property_type" required>
                    <option value="">Select Property Type</option>
                    <option value="House">House</option>
                    <option value="Flat">Flat</option>
                    <option value="Apartment">Apartment</option>
                    <option value="Portion">Portion</option>
                    <option value="Farm House">Farm House</option>
                </select>
            </div>
            <div class="form-group">
                <label for="area_category">Area Category:</label>
                <select id="area_category" name="area_category" required>
                    <option value="">Select Area Category</option>
                    <option value="0-5 Marla">0-5 Marla</option>
                    <option value="5-10 Marla">5-10 Marla</option>
                    <option value="10-20 Marla">10-20 Marla</option>
                    <option value="1-5 Kanal">1-5 Kanal</option>
                    <option value="5-10 Kanal">5-10 Kanal</option>
                </select>
            </div>
            <div class="form-group">
                <label for="latitude">Latitude:</label>
                <input type="number" step="any" id="latitude" name="latitude" required placeholder="e.g., 24.8607">
            </div>
            <div class="form-group">
                <label for="longitude">Longitude:</label>
                <input type="number" step="any" id="longitude" name="longitude" required placeholder="e.g., 67.0011">
            </div>
            <button type="submit">Predict Price</button>
        </form>
        
        <div id="result" class="result"></div>
    </div>

    <script>
        document.getElementById('prediction-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = Object.fromEntries(formData);
            
            // Convert numeric fields and map to correct column names
            const requestData = {
                'bathrooms': parseInt(data.bathrooms) || 0,
                'bedrooms': parseInt(data.bedrooms) || 0,
                'latitude': parseFloat(data.latitude) || 0,
                'longitude': parseFloat(data.longitude) || 0,
                'area': parseFloat(data.area) || 0,
                'property_type': data.property_type || 'House',
                'city': data.city || 'Karachi',
                'province': data.province || 'Sindh',
                'area_category': data.area_category || '5-10 Marla'
            };
            
            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    document.getElementById('result').innerHTML = `
                        <h3>Prediction Result:</h3>
                        <p>Estimated Price: <strong>PKR ${result.predicted_price.toLocaleString()}</strong></p>
                    `;
                    document.getElementById('result').style.display = 'block';
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error making prediction: ' + error.message);
            }
        });
    </script>
</body>
</html>